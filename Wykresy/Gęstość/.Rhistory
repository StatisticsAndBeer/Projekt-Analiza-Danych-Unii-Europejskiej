geom_boxplot(outlier.shape = NA, fill = alpha("blue", 0.1)) +
geom_point(position = jitter, size=2, aes(x = factor(time), y = GDP_pc, color = geo)) +
geom_text_repel(mapping = aes(label=  geo), color = "black",  size = 2,
max.overlaps = 20, position = jitter, min.segment.length = 0) +
scale_y_continuous(n.breaks = 8) +
main_plot_theme
ggplot(data, aes(x = factor(time), y = GDP_pc)) +
geom_boxplot(outlier.shape = NA, fill = alpha("blue", 0.1)) +
geom_point(position = jitter, size=2, aes(x = factor(time), y = GDP_pc, color = geo)) +
geom_text_repel(mapping = aes(label=  geo), color = "black",  size = 2,
max.overlaps = 20, position = jitter, min.segment.length = 0) +
scale_y_continuous(n.breaks = 8) +
main_plot_theme
colnames(data)
data["GDP_pc"]
unlist(data["GDP_pc"])
ggplot(data, aes(x = factor(time), y = unlist(data["GDP_pc"]))) +
geom_boxplot(outlier.shape = NA, fill = alpha("blue", 0.1)) +
geom_point(position = jitter, size=2, aes(x = factor(time), y = GDP_pc, color = geo)) +
geom_text_repel(mapping = aes(label=  geo), color = "black",  size = 2,
max.overlaps = 20, position = jitter, min.segment.length = 0) +
scale_y_continuous(n.breaks = 8) +
main_plot_theme
colnames(data)
vars <- c("DISP_INC_hh", "EXP", "G_CONS", "G_DEBT", "GDP_pc", "HICP", "UNEMP")
var_names <- list(geo = "Kraj",
time = "Czas",
DISP_INC_hh = "Skorygowany dochód rozporządzalny brutto gospodarstw domowych (moc nabywcza)",
EXP = "Eksport towarów i usług [% PKB]",
G_CONS = "Rządowe wydatki na konsumpcję [% PKB]",
G_DEBT = "Zadłużenie rządowe [%PKB]",
GDP_pc = "Przychód krajowy brutto na mieszkańca [EUR]",
HICP = "Wskaźniki cen towarów i usług konsumpcyjnych",
UNEMP = "Stopa bezrobocia",
region = "Strefa")
var_names["GDP_pc"]
var_names[["GDP_pc"]]
for(i in vars){
title <- var_names[[i]]
ggplot(data, aes(x = factor(time), y = unlist(data[i]))) +
geom_boxplot(outlier.shape = NA, fill = alpha("blue", 0.1)) +
geom_point(position = jitter, size=2, aes(x = factor(time), y = GDP_pc, color = geo)) +
geom_text_repel(mapping = aes(label=  geo), color = "black",  size = 2,
max.overlaps = 20, position = jitter, min.segment.length = 0) +
scale_y_continuous(n.breaks = 8) +
xlab("Czas") +
ylab("") +
ggtitle(title) +
main_plot_theme
}
ggplot(data, aes(x = factor(time), y = unlist(data[i]))) +
geom_boxplot(outlier.shape = NA, fill = alpha("blue", 0.1)) +
geom_point(position = jitter, size=2, aes(x = factor(time), y = GDP_pc, color = geo)) +
geom_text_repel(mapping = aes(label=  geo), color = "black",  size = 2,
max.overlaps = 20, position = jitter, min.segment.length = 0) +
scale_y_continuous(n.breaks = 8) +
xlab("Czas") +
ylab("") +
ggtitle(title) +
main_plot_theme
unlist(data[i]))
ggplot(data, aes(x = factor(time), y = unlist(data[i]))) +
geom_boxplot(outlier.shape = NA, fill = alpha("blue", 0.1)) +
geom_point(position = jitter, size=2, aes(x = factor(time), y = GDP_pc, color = geo)) +
geom_text_repel(mapping = aes(label=  geo), color = "black",  size = 2,
max.overlaps = 20, position = jitter, min.segment.length = 0) +
scale_y_continuous(n.breaks = 8) +
# xlab("Czas") +
# ylab("") +
# ggtitle(title) +
main_plot_theme
ggplot(data, aes(x = factor(time), y = unlist(data["GDP_pc"]))) +
geom_boxplot(outlier.shape = NA, fill = alpha("blue", 0.1)) +
geom_point(position = jitter, size=2, aes(x = factor(time), y = GDP_pc, color = geo)) +
geom_text_repel(mapping = aes(label=  geo), color = "black",  size = 2,
max.overlaps = 20, position = jitter, min.segment.length = 0) +
scale_y_continuous(n.breaks = 8) +
# xlab("Czas") +
# ylab("") +
# ggtitle(title) +
main_plot_theme
ggplot(data, aes(x = factor(time), y = unlist(data["UNEMP"]))) +
geom_boxplot(outlier.shape = NA, fill = alpha("blue", 0.1)) +
geom_point(position = jitter, size=2, aes(x = factor(time), y = GDP_pc, color = geo)) +
geom_text_repel(mapping = aes(label=  geo), color = "black",  size = 2,
max.overlaps = 20, position = jitter, min.segment.length = 0) +
scale_y_continuous(n.breaks = 8) +
# xlab("Czas") +
# ylab("") +
# ggtitle(title) +
main_plot_theme
ggplot(data, aes(x = factor(time), y = unlist(data[i]))) +
geom_boxplot(outlier.shape = NA, fill = alpha("blue", 0.1)) +
geom_point(position = jitter, size=2, aes(x = factor(time), y = unlist(data[i]), color = geo)) +
geom_text_repel(mapping = aes(label=  geo), color = "black",  size = 2,
max.overlaps = 20, position = jitter, min.segment.length = 0) +
scale_y_continuous(n.breaks = 8) +
# xlab("Czas") +
# ylab("") +
# ggtitle(title) +
main_plot_theme
title <- var_names[[i]]
ggplot(data, aes(x = factor(time), y = unlist(data[i]))) +
geom_boxplot(outlier.shape = NA, fill = alpha("blue", 0.1)) +
geom_point(position = jitter, size=2, aes(x = factor(time), y = unlist(data[i]), color = geo)) +
geom_text_repel(mapping = aes(label=  geo), color = "black",  size = 2,
max.overlaps = 20, position = jitter, min.segment.length = 0) +
scale_y_continuous(n.breaks = 8) +
xlab("Czas") +
ylab("") +
ggtitle(title) +
main_plot_theme
#Ustalenie wspólnego motywu
main_plot_theme <- theme(legend.position = "none", #brak legendy
panel.background = element_rect(fill = "white"), #białe tło
panel.border = element_rect(colour = "black", fill = NA), #czrana ramka
panel.grid.major.y = element_line(colour = alpha("gray", 0.4)),#szare poziome linie siatki
plot.title = element_text(hjust = 0.5))
#Ustalenie nazw zmiennych
vars <- c("DISP_INC_hh", "EXP", "G_CONS", "G_DEBT", "GDP_pc", "HICP", "UNEMP")
var_names <- list(geo = "Kraj",
time = "Czas",
DISP_INC_hh = "Skorygowany dochód rozporządzalny brutto gospodarstw domowych (moc nabywcza)",
EXP = "Eksport towarów i usług [% PKB]",
G_CONS = "Rządowe wydatki na konsumpcję [% PKB]",
G_DEBT = "Zadłużenie rządowe [%PKB]",
GDP_pc = "Przychód krajowy brutto na mieszkańca [EUR]",
HICP = "Wskaźniki cen towarów i usług konsumpcyjnych",
UNEMP = "Stopa bezrobocia [%]",
region = "Strefa")
title <- var_names[[i]]
ggplot(data, aes(x = factor(time), y = unlist(data[i]))) +
geom_boxplot(outlier.shape = NA, fill = alpha("blue", 0.1)) +
geom_point(position = jitter, size=2, aes(x = factor(time), y = unlist(data[i]), color = geo)) +
geom_text_repel(mapping = aes(label=  geo), color = "black",  size = 2,
max.overlaps = 20, position = jitter, min.segment.length = 0) +
scale_y_continuous(n.breaks = 8) +
xlab("Czas") +
ylab("") +
ggtitle(title) +
main_plot_theme
setwd(paste(project_path, "/WYkresy/Boxloty"))
setwd(paste(project_path, "/Wykresy/Boxloty"))
setwd(paste(project_path, "/Wykresy/Boxploty"))
project_path
setwd(paste(project_path, "/Wykresy/Boxploty"))
setwd(paste(project_path, "/Wykresy/Boxploty", sep=""))
setwd(paste(project_path, "/Wykresy/Boxploty", sep=""))
for(i in vars){
title <- var_names[[i]]
file_name <- paste(ar_names[[i]], ".png", sep="")
p <- ggplot(data, aes(x = factor(time), y = unlist(data[i]))) +
geom_boxplot(outlier.shape = NA, fill = alpha("blue", 0.1)) +
geom_point(position = jitter, size=2, aes(x = factor(time), y = unlist(data[i]), color = geo)) +
geom_text_repel(mapping = aes(label=  geo), color = "black",  size = 2,
max.overlaps = 20, position = jitter, min.segment.length = 0) +
scale_y_continuous(n.breaks = 8) +
xlab("Czas") +
ylab("") +
ggtitle(title) +
main_plot_theme
ggsave(filename = file_name, plot = p, height = 800, width = 1200, units = "px")
}
for(i in vars){
title <- var_names[[i]]
file_name <- paste(var_names[[i]], ".png", sep="")
p <- ggplot(data, aes(x = factor(time), y = unlist(data[i]))) +
geom_boxplot(outlier.shape = NA, fill = alpha("blue", 0.1)) +
geom_point(position = jitter, size=2, aes(x = factor(time), y = unlist(data[i]), color = geo)) +
geom_text_repel(mapping = aes(label=  geo), color = "black",  size = 2,
max.overlaps = 20, position = jitter, min.segment.length = 0) +
scale_y_continuous(n.breaks = 8) +
xlab("Czas") +
ylab("") +
ggtitle(title) +
main_plot_theme
ggsave(filename = file_name, plot = p, height = 800, width = 1200, units = "px")
}
for(i in vars){
title <- var_names[[i]]
file_name <- paste(var_names[[i]], ".png", sep="")
p <- ggplot(data, aes(x = factor(time), y = unlist(data[i]))) +
geom_boxplot(outlier.shape = NA, fill = alpha("blue", 0.1)) +
geom_point(position = jitter, size=2, aes(x = factor(time), y = unlist(data[i]), color = geo)) +
geom_text_repel(mapping = aes(label=  geo), color = "black",  size = 2,
max.overlaps = 20, position = jitter, min.segment.length = 0) +
scale_y_continuous(n.breaks = 8) +
xlab("Czas") +
ylab("") +
ggtitle(title) +
main_plot_theme
ggsave(filename = file_name, plot = p, height = 1600, width = 2400, units = "px")
}
#Ustalenie nazw zmiennych
vars <- c("DISP_INC_hh", "EXP", "G_CONS", "G_DEBT", "GDP_pc", "HICP", "UNEMP")
var_names <- list(geo = "Kraj",
time = "Rok",
DISP_INC_hh = "Skorygowany dochód rozporządzalny brutto gospodarstw domowych (moc nabywcza)",
EXP = "Eksport towarów i usług [% PKB]",
G_CONS = "Rządowe wydatki na konsumpcję [% PKB]",
G_DEBT = "Zadłużenie rządowe [%PKB]",
GDP_pc = "Przychód krajowy brutto na mieszkańca [EUR]",
HICP = "Wskaźniki cen towarów i usług konsumpcyjnych",
UNEMP = "Stopa bezrobocia [%]",
region = "Strefa")
# ggplot(data, aes(x = time, y = GDP_pc, color = geo)) +
#   geom_point(position = jitter, size=2) +
#   geom_text_repel(mapping = aes(label=  geo), color = "black",  size = 2,
#                   max.overlaps = 20, position = jitter, min.segment.length = 0)+
#   geom_vline(xintercept = seq(2019.5, 2022.5, b=1), linetype = "dashed") +
#   scale_y_continuous(n.breaks = 8) +
#   main_plot_theme
setwd(paste(project_path, "/Wykresy/Boxploty", sep=""))
for(i in vars){
title <- var_names[[i]]
file_name <- paste(var_names[[i]], ".png", sep="")
p <- ggplot(data, aes(x = factor(time), y = unlist(data[i]))) +
geom_boxplot(outlier.shape = NA, fill = alpha("blue", 0.1)) +
geom_point(position = jitter, size=2, aes(x = factor(time), y = unlist(data[i]), color = geo)) +
geom_text_repel(mapping = aes(label=  geo), color = "black",  size = 2,
max.overlaps = 20, position = jitter, min.segment.length = 0) +
scale_y_continuous(n.breaks = 8) +
xlab("Czas") +
ylab("") +
ggtitle(title) +
main_plot_theme
ggsave(filename = file_name, plot = p, height = 1600, width = 2400, units = "px")
}
setwd(paste(project_path, "/Wykresy/Boxploty", sep=""))
for(i in vars){
title <- var_names[[i]]
file_name <- paste(var_names[[i]], ".png", sep="")
p <- ggplot(data, aes(x = factor(time), y = unlist(data[i]))) +
geom_boxplot(outlier.shape = NA, fill = alpha("blue", 0.1)) +
geom_point(position = jitter, size=2, aes(x = factor(time), y = unlist(data[i]), color = geo)) +
geom_text_repel(mapping = aes(label=  geo), color = "black",  size = 2,
max.overlaps = 20, position = jitter, min.segment.length = 0) +
scale_y_continuous(n.breaks = 8) +
xlab("Rok") +
ylab("") +
ggtitle(title) +
main_plot_theme
ggsave(filename = file_name, plot = p, height = 1600, width = 2400, units = "px")
}
rm(i, p, filename, title)
setwd(project_path)
rm(i, p, file_name, title)
setwd(project_path)
rm(i, p, file_name, title, jitter, main_plot_theme)
setwd(project_path)
View(CNTR_data)
data$time <- as.factor(data%time)
data$time <- as.factor(data$time)
data$geo <- as.factor(data$geo)
?Error
#ANOVA =========================================================================
#ANOVA dla zmiennych przez lata
data$time <- as.factor(data$time)
data$geo <- as.factor(data$geo)
model <- aov(GDP_pc ~ time + Error(geo/time), data = data)
anova(model)
summary(model)
Error(data$geo/data$time)
model <- aov(HICP ~ time + Error(geo/time), data = data)
summary(model)
model <- aov(G_DEBT ~ time + Error(geo/time), data = data)
summary(model)
ggplot(data, aes(x = factor(time), y = GDP_pc)) +
geom_histogram()
ggplot(data, aes(y = GDP_pc, group = time)) +
geom_histogram()
scale_y_continuous(n.breaks = 8) +
xlab("Rok") +
ylab("") +
ggtitle(title) +
main_plot_theme
ggplot(data, aes(y = GDP_pc, group = time)) +
geom_histogram() +
scale_y_continuous(n.breaks = 8) +
xlab("Rok") +
ylab("") +
ggtitle(title) +
main_plot_theme
#Rozrzut punktów (dla czytelności)
jitter <- position_jitter(width = 0.3, height = 0, seed=123)
#Ustalenie wspólnego motywu
main_plot_theme <- theme(legend.position = "none", #brak legendy
panel.background = element_rect(fill = "white"), #białe tło
panel.border = element_rect(colour = "black", fill = NA), #czrana ramka
panel.grid.major.y = element_line(colour = alpha("gray", 0.4)),#szare poziome linie siatki
plot.title = element_text(hjust = 0.5))
ggplot(data, aes(y = GDP_pc, group = time)) +
geom_histogram() +
scale_y_continuous(n.breaks = 8) +
xlab("Rok") +
ylab("") +
ggtitle(title) +
main_plot_theme
ggplot(data, aes(y = GDP_pc, group = time)) +
geom_histogram(bins = 15) +
scale_y_continuous(n.breaks = 8) +
xlab("Rok") +
ylab("") +
ggtitle(title) +
main_plot_theme
ggplot(data, aes(x = GDP_pc, group = time)) +
geom_histogram(bins = 15) +
scale_y_continuous(n.breaks = 8) +
xlab("Rok") +
ylab("") +
ggtitle(title) +
main_plot_theme
ggplot(data, aes(x = GDP_pc)) +
geom_histogram(bins = 15) +
scale_y_continuous(n.breaks = 8) +
xlab("Rok") +
ylab("") +
ggtitle(title) +
main_plot_theme
ggplot(data, aes(x = GDP_pc)) +
geom_histogram(bins = 15) +
scale_y_continuous(n.breaks = 8) +
xlab("Rok") +
ylab("") +
ggtitle("Tytuł") +
main_plot_theme
ggplot(data, aes(x = GDP_pc, group = time)) +
geom_histogram(bins = 15) +
scale_y_continuous(n.breaks = 8) +
xlab("Rok") +
ylab("") +
ggtitle("Tytuł") +
main_plot_theme
ggplot(data, aes(x = GDP_pc, color = time, fill = time)) +
geom_histogram(bins = 15) +
scale_y_continuous(n.breaks = 8) +
xlab("Rok") +
ylab("") +
ggtitle("Tytuł") +
main_plot_theme
ggplot(data, aes(x = GDP_pc, color = time, fill = time)) +
geom_histogram(aes(y = ..density.. ),bins = 15)
ggplot(data, aes(x = GDP_pc)) +
geom_histogram(aes(y = ..density.. ),bins = 15) +
facet_wrap(~year, nrow = 1)
ggplot(data, aes(x = GDP_pc)) +
geom_histogram(aes(y = ..density.. ),bins = 15) +
facet_wrap(~time, nrow = 1)
ggplot(data, aes(x = GDP_pc)) +
geom_histogram(aes(y = ..density.. ),bins = 15) +
facet_wrap(~time, nrow = 1) +
scale_y_continuous(n.breaks = 8) +
xlab("Rok") +
ylab("") +
ggtitle("Tytuł") +
main_plot_theme
ggplot(data, aes(x = GDP_pc)) +
geom_histogram(aes(y = ..density.. ),bins = 15) +
facet_wrap(~time, nrow = 1) +
scale_y_continuous(n.breaks = 5) +
scale_x_continuous(n.breaks = 3) +
xlab("Rok") +
ylab("") +
ggtitle("Tytuł") +
main_plot_theme
ggplot(data, aes(x = GDP_pc)) +
geom_histogram(aes(y = ..density.. ),bins = 55) +
facet_wrap(~time, nrow = 1) +
scale_y_continuous(n.breaks = 8) +
scale_x_continuous(n.breaks = 3) +
xlab("Rok") +
ylab("") +
ggtitle("Tytuł") +
main_plot_theme
ggplot(data, aes(x = GDP_pc)) +
geom_histogram(aes(y = ..density.. ),bins = 5) +
facet_wrap(~time, nrow = 1) +
scale_y_continuous(n.breaks = 8) +
scale_x_continuous(n.breaks = 3) +
xlab("Rok") +
ylab("") +
ggtitle("Tytuł") +
main_plot_theme
ggplot(data, aes(x = GDP_pc)) +
geom_histogram(aes(y = ..density.. ),bins = 10) +
facet_wrap(~time, nrow = 1) +
scale_y_continuous(n.breaks = 8) +
scale_x_continuous(n.breaks = 3) +
xlab("Rok") +
ylab("") +
ggtitle("Tytuł") +
main_plot_theme
ggplot(data, aes(x = GDP_pc)) +
geom_density() +
facet_wrap(~time, nrow = 1) +
scale_y_continuous(n.breaks = 8) +
scale_x_continuous(n.breaks = 3) +
xlab("Rok") +
ylab("") +
ggtitle("Tytuł") +
main_plot_theme
ggplot(data, aes(x = GDP_pc)) +
geom_density(fill = "blue", alpha =0.03) +
facet_wrap(~time, nrow = 1) +
scale_y_continuous(n.breaks = 8) +
scale_x_continuous(n.breaks = 3) +
xlab("Rok") +
ylab("") +
ggtitle("Tytuł") +
main_plot_theme
ggsave(filename = file_name, plot = p, height = 1600, width = 2400, units = "px")
ggplot(data, aes(x = GDP_pc)) +
geom_density(fill = "blue", alpha =0.03) +
facet_wrap(~time, nrow = 1) +
scale_y_continuous(n.breaks = 8) +
scale_x_continuous(n.breaks = 3) +
ylab("") +
ggtitle("Tytuł") +
main_plot_theme
ggplot(data, aes(x = GDP_pc)) +
geom_density(fill = "blue", alpha =0.1) +
facet_wrap(~time, nrow = 1) +
scale_y_continuous(n.breaks = 8) +
scale_x_continuous(n.breaks = 3) +
ylab("") +
ggtitle("Tytuł") +
main_plot_theme
data[data$time==2019,"GDP_pc"]
shapiro.test(data[data$time==2019,"GDP_pc"])
shapiro.test(unlist(data[data$time==2019,"GDP_pc"]))
shapiro.test(unlist(data[data$time==2020,"GDP_pc"]))
shapiro.test(unlist(data[data$time==2020,"HICP"]))
shapiro.test(scale(unlist(data[data$time==2020,"GDP_pc"])))
scale(unlist(data[data$time==2020,"GDP_pc"]))
shapiro.test(scale(unlist(data[data$time==2020,"HICP"])))
title <- var_names[[i]]
ggplot(data, aes(x = GDP_pc)) +
geom_density(fill = "blue", alpha =0.1) +
facet_wrap(~time, nrow = 1) +
scale_y_continuous(n.breaks = 8) +
scale_x_continuous(n.breaks = 5) +
ylab("Częstotliwość") +
xlab("Wartość zmiennej")
ggtitle(title) +
main_plot_theme +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(data, aes(x = GDP_pc)) +
geom_density(fill = "blue", alpha =0.1) +
facet_wrap(~time, nrow = 1) +
scale_y_continuous(n.breaks = 8) +
scale_x_continuous(n.breaks = 5) +
ylab("Częstotliwość") +
xlab("Wartość zmiennej") +
ggtitle(title) +
main_plot_theme +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
title
title <- var_names[[i]]
i <- "GDP_pc"
title <- var_names[[i]]
ggplot(data, aes(x = GDP_pc)) +
geom_density(fill = "blue", alpha =0.1) +
facet_wrap(~time, nrow = 1) +
scale_y_continuous(n.breaks = 8) +
scale_x_continuous(n.breaks = 5) +
ylab("Częstotliwość") +
xlab("Wartość zmiennej") +
ggtitle(title) +
main_plot_theme +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
setwd(paste(project_path, "/Wykresy/Gęstość", sep=""))
for(i in vars){
title <- var_names[[i]]
file_name <- paste(var_names[[i]], " gestosc.png", sep="")
p <- ggplot(data, aes(x = GDP_pc)) +
geom_density(fill = "blue", alpha =0.1) +
facet_wrap(~time, nrow = 1) +
scale_y_continuous(n.breaks = 8) +
scale_x_continuous(n.breaks = 5) +
ylab("Częstotliwość") +
xlab("Wartość zmiennej") +
ggtitle(title) +
main_plot_theme +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggsave(filename = file_name, plot = p, height = 1600, width = 2400, units = "px")
}
for(i in vars){
title <- var_names[[i]]
file_name <- paste(var_names[[i]], " gestosc.png", sep="")
p <- ggplot(data, aes(x = unlist(data[i]))) +
geom_density(fill = "blue", alpha =0.1) +
facet_wrap(~time, nrow = 1) +
scale_y_continuous(n.breaks = 8) +
scale_x_continuous(n.breaks = 5) +
ylab("Częstotliwość") +
xlab("Wartość zmiennej") +
ggtitle(title) +
main_plot_theme +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggsave(filename = file_name, plot = p, height = 1600, width = 2400, units = "px")
}
ggplot(data, aes(x = time, y = unlist(data[i]))) +
geom_boxplot(outlier.shape = NA, fill = alpha("blue", 0.1)) +
geom_point(position = jitter, size=2,
aes(x = time, y = unlist(data[i]), color = geo)) +
geom_text_repel(mapping = aes(label=  geo), color = "black",  size = 2,
max.overlaps = 20, position = jitter, min.segment.length = 0) +
scale_y_continuous(n.breaks = 8) +
xlab("Rok") +
ylab("") +
ggtitle(title) +
main_plot_theme
