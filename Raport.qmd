---
title: "Raport"
author: "Dominik Mieszkowski, Dagmara y"
format: 
  html:
    theme: cerulean
    #code-fold: true # dzieki temu ka偶dy fragment kodu jest zwijany, mo偶na to zmieni przy poszcezg贸lnych fragmentach 
    code-tools: true # dodaje przyciski: copy/show/hide code
    toc: true #(table of contents) 
    toc_float: true # latajca tabela kontekst贸w nawet przy scrollowaniu 
    toc_depth: 2 # "gboko" z jak pokazujc si headery w toc
    number-sections: false # opcja chowa numerowanie header贸w 
    toc-location: right # po kt贸rej stronie jest toc
editor: visual
---

# Analiza wybranych wzka藕nik贸w makroekonomicznych w krajach Unii Europejskiej w latach 2019-2025

Dagmara y, s211011\@sggw.edu.pl\
Dominik Mieszkowski s211015\@sggw.edu.pl\

## Wprowadzenie

Wska藕niki makroekonomiczne peni kluczow rol w opisywaniu i ocenie sytuacji gospodarczej kraju. Ich wartoci odzwierciedlaj sytuacj finasow rzdu pastwa, a tak偶e warunki ekonomiczne w jakich funkcjonuj przdesibiorstwa i gospodartwa domowe na jego terenie. W ostatnich latach wybuch pandemii wirusa COVID-19 w 2020 r., a tak偶e rozpoczcie przez Rosj wojny na Ukrainie w lutym 2022 r. wstrzsny Europ, wpywajc na handel, rynek pracy i ludno. Aby oceni rodzaj i zakres zmian spoeczno-ekonomicznych w tym okresie, koniecznym jest przyjrzenie si zmianom w wartociach wspomnainych wska藕nik贸w, kt贸re towarzyszyly tym wydarzeniom. Temat ten jest podjty w tej pracy, uwzgldniajc 27 patw obecnie wchodzcych w skad Unii Europejskiej w latach 2019-2023.

### Streszczenie

### Sowa kluczowe

wska藕nk makroekonomiczny, Unia Europejska, COVID-19, wojna, nier贸wno, analiza Wizualna, test Wilcoxona, krzywa Lorenza, indeks Gini'ego

### Cele i hipotezy

Celem badania jest wykazanie wpywu pandemii COVID-19 oraz wybuchu wojny na Ukrainie na sytuacj gospodarcz kraj贸w Unii Europejskiej. Zmiana taka powinna by odzwierciedlona zauwa偶aln r贸偶nic w wartocich wybranych wska藕nik贸w makroekonomicznych w czasie, dotyczc caoksztatu Unii Europejskiej. Zmiana taka mo偶e mie jednolity charakter i dotyczy wszytskich pastw w jednakowy spos贸b lub mie wpywa na pastwa w r贸偶nym stopniu, redukujc lub amplifikujc wystpujce midzy pastwami wystpujce uprzednio na danym tle nier贸wnoci. Cel 贸w jest r贸noznaczny z potwierdzeniem dw贸ch hipotez badawczych:

-   Pandemia COVID-19 miay negatywny wpyw na sytuacj ekonomiczn kraj贸w Unii Europejskiej oraz jej ludnoci.
-   Zmiany wywoane tymi wydarzeniami nie dotykay kraj贸w jednakowo, powodujc zmiany w wystpujcych midzy nimi nier贸wnociach makroekonomicznych.

### Przegld literatury

## Dane

```{r}
#| echo: false
#| warning: false
#| message: false
p<-c("eurostat", "tidyr", "tmap", "sf", "dplyr", "stringr", "purrr",
     "ggplot2", "tidyr", "reshape2", "dplyr", "stringr", "ineq", "knitr", 
     "moments")

for (i in p){
  #if(!require(i, character.only = TRUE)){install.packages(i)}
  if(!i %in% installed.packages()){
    install.packages(i)
  }
  library(i, character.only = TRUE)
}
rm(p, i)



#Wczytanie kod贸w pastw UE
CNTR_eu<-unlist(eu_countries %>%
  mutate(geo=code) %>%
  select(geo))
YEARS=2019:2023

project_path <- "C:\\Users\\dagma\\OneDrive\\Pulpit\\PROJEKT_EMOS\\Projekt-Analiza-Danych-Unii-Europejskiej"
#project_path <- "C:/Users/miesz/Desktop/Studia/Projekt-Analiza-Danych-Unii-Europejskiej"

setwd(project_path)
# WCZYTANIE DANYCH Z EUROSTATU ####
# Real GDP per capita ####
#ewentualnie "sdg_08_10" bo jako base year u偶ywa 2020, a nie 2015
GDP_pc<- get_eurostat(id = "tipsna40", time_format = "num",
                      filters = list(time = YEARS, 
                                     freq = "A", 
                                     geo = CNTR_eu)) %>%
  select(geo, time, values) %>%
  rename(GDP_pc = values)


# Uneployment Rate ####
UNEMP <- get_eurostat(id = "tps00203", time_format = "num",
                      filters = list(time = YEARS, 
                                     freq = "A", 
                                     geo = CNTR_eu, 
                                     unit = "PC_ACT")) %>%
  select(geo, time, values) %>%
  rename(UNEMP = values)



# HICP - inflation rate
HICP <- get_eurostat(id = "tec00118", time_format = "num",
                     filters = list(time = YEARS, 
                                    freq = "A", 
                                    geo = CNTR_eu)) %>%
  select(geo, time, values) %>%
  rename(HICP = values)


# Governemntal consumption expenditure (Percentage of GDP) ####
G_CONS <- get_eurostat(id = "tec00010", time_format = "num",
                       filters = list(time = YEARS, 
                                      freq = "A", 
                                      geo = CNTR_eu, 
                                      unit = "CP_MEUR")) %>%
  select(geo, time, values) %>%
  rename(G_CONS = values)



# General government gross debt - Percentage of gross domestic product (GDP) ####
G_DEBT <- get_eurostat(id = "sdg_17_40", time_format = "num",
                       filters = list(time = YEARS, 
                                      freq = "A", 
                                      geo = CNTR_eu, 
                                      unit = "PC_GDP")) %>%
  select(geo, time, values) %>%
  rename(G_DEBT = values)


# Adjusted gross disposable income of households per capita in PPS ####
DISP_INC_hh <- get_eurostat(id = "tec00113", time_format = "num",
                            filters = list(time = YEARS, 
                                           freq = "A", 
                                           geo = CNTR_eu)) %>%
  select(geo, time, values) %>%
  rename(DISP_INC_hh = values)


# Export of goods and servieces in % of GDP ####
EXP <- get_eurostat(id = "nama_10_gdp", time_format = "num",
                    filters = list(time = YEARS, 
                                   freq = "A", 
                                   geo = CNTR_eu,
                                   na_item = "P6",
                                   unit = "CLV15_MEUR")) %>%
  select(geo, time, values) %>%
  rename(EXP = values)

dfs <- list(DISP_INC_hh, EXP, G_CONS, G_DEBT, GDP_pc,
            HICP, UNEMP)
data <- reduce(dfs, function(x, y) full_join(x, y, by = c("geo", "time")))

rm(DISP_INC_hh, EXP, G_CONS, G_DEBT, GDP_pc,
   HICP, UNEMP)
rm(dfs)


eu_north <- c("DK", "EE", "FI", "IE", "LV", "LT", "SE")
eu_south <- c("HR", "CY", "EL", "IT", "MT", "PT", "SI", "ES")
eu_east  <- c("BG", "CZ", "HU", "PL", "RO", "SK")
eu_west  <- c("AT", "BE", "FR", "DE", "LU", "NL")

data <- data %>%
  mutate(region = case_when(
    geo %in% eu_north ~ "North",
    geo %in% eu_south ~ "South",
    geo %in% eu_east  ~ "East",
    geo %in% eu_west  ~ "West"))

rm(eu_east, eu_south, eu_north, eu_west)

data$time <- as.factor(data$time)
data$geo <- as.factor(data$geo)



# Obliczanie NA dla Bugari w DISP_INC_hh
# Microeconometrics (Methods and Applications) || Missing Data and Imputation 
# Cambridge University Press, 2005 may 09
# Cameron, A. Colin; Trivedi, Pravin K
#930-932

#uzupenianie brakujcej danej
# MODEL Z CZASEM 
danee<-data
danee$time <- as.numeric(as.character(danee$time))
model_data <- danee[danee$geo == "BG", ] %>% filter(!is.na(DISP_INC_hh)) 

#model dla bugarii
model <- lm(DISP_INC_hh ~ time, data = model_data)


missing_rows <- danee %>%
  filter(is.na(DISP_INC_hh) & geo == "BG") %>%
  select(time, DISP_INC_hh)

predicted <- predict(model, newdata = missing_rows)

data$DISP_INC_hh[danee$geo == "BG" & is.na(danee$DISP_INC_hh)] <- predicted

rm(danee, missing_rows, model, model_data, predicted)

```

### 殴r贸do i zakres danych

Dane pochodz w caoci ze zbior贸w udostpnionych przez Eurostat. Szczeg贸y dotyczcze baz danych, z kt贸rych pochodz poszczeg贸lne wska藕niki opisane s w sekcji powiconej opisowi zmiennych. Zbi贸r danych obejmuje wartoci 7 wska偶nik贸w makroekonometrycznych, podawanych z roczn czstotliwoci na przestrzeni lat 2019-2023. W badaniu uwzgldnione zostao 27 pastw wchodzcych w skad Unii Europejskiej z roku 2020. W badaniu nie zostay uwzgldnione kraje nienale偶ce do Unii Europejskiej, ale wp贸pracujce z Eurostatem w zakresie statystyki publicznej.

### Opis zmiennych

Tak jak wspomnaino wy偶ej badane zmienne stanowi 7 wska藕nik贸w makroekonomicznych: Przych贸d krajowy brutto na mieszkaca, Stopa bezrobocia, Wska藕nik cen towar贸w i usug koncumpcyjnych, Wydati rzdowe na konsumpcj, Zadu偶enie rzdowe brutto, Skorygowany doch贸d brutto do dyspozycji na mieszkaca, Eksport towar贸w i usug. Szczag贸y dotyczce zmiennych przedstawiono poni偶ej

| Nazwa       | Opis                                                                               | Jednostka                                                | Baza Danych |
|:-----------------|:-----------------|:-----------------|:------------------|
| GDP_pc      | Przych贸d krajowy brutto na miszkaca                                               | wolumeny acuchowo powizane (2015), euro na mieszkaca | tipsna40    |
| UNEMP       | Stopa bezrobocia                                                                   | \%                                                       | tps00203    |
| HICP        | Wska藕niki cen towar贸w i usug konsumpcyjnych (pot. infalcja)                       | \-                                                       | tec00118    |
| G_CONS      | Wydatki rzdowe na konsumpcj                                                      | milion euro, ceny bie偶ce                                | tec00010    |
| G_DEBT      | Zadu偶enie rzdowe brutto                                                          | \% PKB                                                   | sdg_17_40   |
| DISP_INC_hh | Skorygowany doch贸d rozporzdzany doch贸d gospodarstw domowych na jednego mieszkaca | standard siy nabywczej (PPS 2020)                       | tec00113    |
| EXP         | Eksport towar贸w i usug                                                            | wolumeny acuchowo powizane (2015), milion euro        | nama_10_gdp |

### Statystyki opisowe

Poznanie podstawowaych statystyk opisowych pozwli na lepsze zrozumienie struktury badanych zmiennych makroekonomicznych. Dziki temu mo偶liwe jest dowiedzenie si, jak na przestrzeni lat - zar贸wno w okresie poprzedzajcym pandemi COVID-19, kt贸rej restrykcje zaczey obowizywa w Europie od marca 2020 roku, jak i inwazji Rosji na Ukrain trwajcej od lutego 2022, wpyney na gospodarki pastw Unii Europejskiej. 

```{r}
#| echo: false
#| warning: false
#| message: false

podstawowe_statystyki <- function(df) {
  statystyki <- data.frame(
    Minimum = sapply(df, function(x) min(x, na.rm = TRUE)),
    Kwantyl1 = sapply(df, function(x) quantile(x, 0.25, na.rm = TRUE)),
    Srednia = sapply(df, function(x) mean(x, na.rm = TRUE)),
    Mediana = sapply(df, function(x) median(x, na.rm = TRUE)),
    OdchStand = sapply(df, function(x) sd(x, na.rm = TRUE)),
    Kwantyl3 = sapply(df, function(x) quantile(x, 0.75, na.rm = TRUE)),
    Maksimum = sapply(df, function(x) max(x, na.rm = TRUE)),
    Skosnosc = sapply(df, function(x) skewness(x, na.rm = TRUE)),
    Kurtoza = sapply(df, function(x) kurtosis(x, na.rm = TRUE)),
    #Braki = sapply(df, function(x) sum(is.na(x))), 
    WspZmiennosci = sapply(df, function(x) {
      m <- mean(x, na.rm = TRUE)
      s <- sd(x, na.rm = TRUE)
      if (is.na(m) || m == 0) return(NA)
      else return(s / m)
    })
  )
  statystyki<-t(statystyki)
  nazwy_rows<-c("Minimum", "Kwantyl 1", "rednia", "Mediana", "Odchylenie standardowe", "Kwantyl 3", "Maksimum", "Skono", "Kurtoza", "Wsp贸czynnik zmiennoci")
  row.names(statystyki)<-nazwy_rows
  
  
  return(round(statystyki, 2))
}


kable(podstawowe_statystyki(select(data[data$time==2019,], c(-time, -geo, -region))), caption = "Statystyki dla roku 2019")
kable(podstawowe_statystyki(select(data[data$time==2020,], c(-time, -geo, -region))), caption = "Statystyki dla roku 2020")
kable(podstawowe_statystyki(select(data[data$time==2021,], c(-time, -geo, -region))), caption = "Statystyki dla roku 2021")
kable(podstawowe_statystyki(select(data[data$time==2022,], c(-time, -geo, -region))), caption = "Statystyki dla roku 2022")
kable(podstawowe_statystyki(select(data[data$time==2023,], c(-time, -geo, -region))), caption = "Statystyki dla roku 2023")

```

Warto zauwa偶y, 偶e dla wszystkich uwzgldnionych w badaniu okresach wsp贸czynnik skonoci przyjmuje warto dodatni wr贸d zbioru danych. Czyli mo偶na oczekiwa, 偶e por贸d pastw zdarzaj si wartoi odstajce. Mo偶e to sugerowa, 偶e dla tych danych lepsz miar tendencji centralnej oka偶e si mediana. Uwag jednak zwracaj zmienne EXP - Eksport towar贸w i usug i G_CONS - Wydatki rzdowe na konsumpcj w mln EURO w cenach bie偶cych, ze wzgldu na wysokie wartoci powy偶ej 2. Oznacza to, 偶e du偶e wartoci odstajce s przyjmowane przez nie rzadko, jednak znaczco wpywaj na struktur danych. 

Kurtoza wikszoci zmiennych we wszytkich badanych latach ma warto blisk, lub powy偶ej 3 co sugeruje du偶e wartoci obserwacji odstajcych. Podobnie jak w przypadku skonoci zmiennymi, kt贸re maj rozkad leptokurtyczny s EXP i G_CONS, mo偶na zatem sdzi, 偶e midzy krajami Unii Europejskiej, to zmienne najbardziej por贸偶niajce.
Ze wzgldu na dodatnie wartoci skonoci i kurtozy warto rozwa偶y w dalszym badaniu zlogarytmownie tych zmiennych, aby posiaday rozkad normlany.

Dla wszystkich badanych okres贸w, wsp贸czynnik zmiennoci badany jako iloczyn odchylenia standardowego i redniej wynosi powy偶ej wartoci krytycznej przyjmowanej najczciej na poziomie 0,1, wic badane dane wykazuj si wystarczajc zmiennoci by uwzgldnia je w badaniu. 


### Wykresy gstoci zmiennych
```{r}
#| echo: false
#| warning: false
#| message: false
#| include: false
#Ograniczenie wywietlania liczb w notacji wykadniczej
options(scipen = 9999)

#Rozrzut punkt贸w (dla czytelnoci)
jitter <- position_jitter(width = 0.3, height = 0, seed=123)

#Ustalenie wsp贸lnego motywu
main_plot_theme <- theme(legend.position = "none", #brak legendy
                         panel.background = element_rect(fill = "white"), #biae to
                         panel.border = element_rect(colour = "black", fill = NA), #czrana ramka
                         panel.grid.major.y = element_line(colour = alpha("gray", 0.4)),#szare poziome linie siatki
                         plot.title = element_text(hjust = 0.5)) 

vars <- c("DISP_INC_hh", "EXP", "G_CONS", "G_DEBT", "GDP_pc", "HICP", "UNEMP")
var_names <- list(geo = "Kraj",
                  time = "Rok",
                  DISP_INC_hh = "Skorygowany doch贸d brutto gospodarstw domowych do dyspozycji [standard mocy nabywzcej, (PPS 2020)]",
                  EXP = "Eksport towar贸w i usug [wolumeny acuchowo powizane (2015), milion euro]",
                  G_CONS = "Rzdowe wydatki na konsumpcj [milion euro, bie偶ce ceny]",
                  G_DEBT = "Zadu偶enie rzdowe [% PKB]",
                  GDP_pc = "Przych贸d krajowy brutto na mieszkaca [wolumeny acuchowo powizane (2015), euro na mieszkaca]",
                  HICP = "Wska藕niki cen towar贸w i usug konsumpcyjnych",
                  UNEMP = "Stopa bezrobocia [%]",
                  region = "Strefa")

```


```{r}
#| echo: false
#| warning: false
#| message: false
#| include: false
setwd(paste(project_path, "/Wykresy/Gsto", sep=""))


for(i in vars){
  title <- str_wrap(var_names[[i]], width = 70)
  
  file_name <- paste(i, " gestosc.png", sep="")
  
  p <- ggplot(data, aes(x = unlist(data[i]))) +
    geom_density(fill = "blue", alpha =0.1) +
    facet_wrap(~time, nrow = 1) +
    scale_y_continuous(n.breaks = 8) + 
    scale_x_continuous(n.breaks = 5) +
    ylab("Czstotliwo") + 
    xlab("Warto zmiennej") +
    ggtitle(title) +
    main_plot_theme +
    theme(axis.text.x = element_text(angle = 45, hjust = 1))
  
  ggsave(filename = file_name, plot = p, height = 1600, width = 2400, units = "px")
}

rm(i, p, file_name, title)

setwd(project_path)


```
![Gsto_DISP_INC_hh](Wykresy/Gsto/DISP_INC_hh gestosc.png)
Odczytujc powy偶szy wykres gstoci (DISP_INC_hh) Skorygowanego dochodu brutto gospodarstw domowych mo偶na zauwa偶y, 偶e na przestrzeni badanego okresu doszo do nieznacznego zmniejszenia si r贸偶nic midzy badanymi krajam. Potwierdzaj to tak偶e wartoci kurtozy i skonoci, ktore z roku na rok (opr贸cz 2022) regularnie nieznacznie malay. Oznacza to, 偶e struktura dyspozycyjnego dochodu gospodarstw domowych midzy krajami UE ulega powolnej r贸wnowadze.

![Gsto_EXP](Wykresy/Gsto/EXP gestosc.png)
Rozkad EXP eksportu towar贸w i usug jest silnie prawostronny co wynikao tak偶e ze statystyk opisowych. Warto jednak wspomnie, 偶e jak wynika z raportu OECD Economic Surveys: European Union 2021; spodziwano si, 偶e w roku 2020 eksport d贸br i towar贸w zmiejszy si o niemal 8,9% dla kraj贸w Unii Europejskiej. 


![Gsto_G_CONS](Wykresy/Gsto/G_CONS gestosc.png)
Rozkady rzdowych wydatk贸w na konsumpcj pokazuje, 偶e struktura tych wydatk贸w nie ulegaa an przestrzeni lat znaczej zmianie. Tym samym utrzymywa on rokad prawostronny. 

![Gsto_G_DEBT](Wykresy/Gsto/G_DEBT gestosc.png)
Na podstawie pozyzego wykresu zadu偶enia rzdowego, widac wyra藕nie 偶e jego rozkd jest asymetryczny i prawostronny. Patrzc na wykres, mo偶na odnie wra偶enie, 偶e skono tej zmiennej ulega minimalnym zmianom- co r贸wnie偶 wynika ze statystyk opisowych. 


![Gsto_GDP_pc](Wykresy/Gsto/GDP_pc gestosc.png)
Przych贸d krajowy brutto per capita nie uleg znacznym zmianom. Zwykres贸w gstoci tej zmiennej mo偶na zauwa偶y, 偶e w badanym okresie nie zaszy znaczce zmiany dla badanych kraj贸w. 

![Gsto_HICP](Wykresy/Gsto/HICP gestosc.png)
Warto zatrzyma si przy rozkadzie gstoci inflacji, kt贸rej wartoci po rozpoczciu wojny na ukrainie znaczco wzrosy. Jak podaje rapot OECD Economic Surveys: European Union 2021 - inflacja w roku 2020 w krajach UE spada, a w strefie kraj贸w Euro nawet przyjmowaa wartoi ujemne. Tym samym widac jak ogromnym ciosem dla Europejskiej gospodarki by wybuch wojny na Ukrainie. Wzrosty cen energii i wydatk贸w na obron jest tylko kilka z skutk贸w Rosyjskiej inwazji.
![Gsto_UNEMP](Wykresy/Gsto/UNEMP gestosc.png)
Jak wida nie ma znaczcych zmian w strukt贸rze bezrobocia pastw UE na przestrzeni lat 2019-2023. Rozkad zmiennej pozostawa prawostronny. 





### Badanie normalnoci rozkadu

W celu okrelenia czy nale偶y uzna, 偶e badane obserwacje pochodz z rozkadu normalnego wykonano wykresy kwantyl-kwantyl oraz przeprowadzono testy statystyczne Shapiro wilka.

```{r}
#| echo: false
#| warning: false
#| message: false
#| include: false
setwd(paste(project_path, "/Wykresy/q-q", sep=""))

title <- str_wrap("Wykresy kwantyl-kwantyl dla poszczeg贸lnych zmiennych na przestrzeni lat", width = 50)

q_q_data <- melt(data=data, id.vars = c("time", "geo", "region"), 
                 variable.name = "variable", value.name = "value")

file_name <- paste("Wykres q-q.png")
title <- str_wrap("Wykresy kwantyl-kwantyl dla poszczeg贸lnych zmiennych na przestrzeni lat",
                  width = 50)
  
p <- ggplot(q_q_data, aes(sample = value)) +
  geom_qq_line() +
  geom_qq()+
  facet_grid(rows = vars(variable), cols = vars(time), scales = "free") +
  scale_y_continuous(n.breaks = 4) +
  ylab("Wartoci rzeczywste zmiennych") +
  xlab("Teoretyczne wartoci rozkadu normalnego") +
  ggtitle(title) +
  main_plot_theme +
  theme(panel.grid.major.x = element_line(colour = alpha("gray", 0.4)))
  
ggsave(filename = file_name, plot = p, height = 2400, width = 1800, units = "px")


rm(p, file_name, q_q_data)

```

![Wykres q-q](Wykresy/q-q/Wykres%20q-q.png)

Wykresy kwartyl-kwartyl por贸wnujce rozkad badanych wska藕nik贸w w krajach Unii Europejskiej ze standardowym rozkadem normalnym zdaj si wykazywa rozbie偶no midzy nimi. Eksport towar贸w i usug (EXP), Rzdowe wydatki na konsumpcj (G_CONS), Zadu偶enie rzdowe (G_DEBT), PKB na mieszkaca (GDP-pc) oraz Stopa Bezrobocia (UNEMP) niezale偶nie do roku charakteryzuj si obserwacjami po prawej stronie poo偶onymi zauwa偶alnie powy偶ej linii symbolizujcej rozkad normalny. Zjawisko to jest szczeg贸lnie silne w przypadku Eksportu oraz Wydatk贸w na konsumpcj. Wzorzec taki odzwierciedla istnienie kraj贸w plasujcych si pod tymi wzgldami znaczcow wy偶ej od pozostaych, co oznacza niesymetryczny rozkad obserwacji wok贸 redniej.

W przypadku niekt贸rych wska藕nik贸w, np. Dochod贸w gospodarstw domowych od dyspozycji (DISP_INC_hh) oraz Eksportu towar贸w i usug (EXP) zauwa偶y te偶 mo偶na analogiczne zjawisko dla niskich wartoci wska藕nik贸w (reprezentowanych po lewej stronie wykres贸w) lecz nie jest ono tak zauwa偶alne jak w przyadku wartoci wysokich.

Wykrey Indeksu cen towar贸w i usug konsumenckich (HICP) oraz Stopy bezrobocia (UNEMP) w najbardziej zauwa偶alny spos贸b zmieniaj si w czasie. W przypadku Indeksu cen towar贸w i usug konsumenckich, zmiana ta wskazuje na wstrzs towarzyszcy rozpoczciu wojny w roku 2022, kt贸ry doproadzi do og贸lnego wzrostu iinfalcji, w spos贸b nier贸wnomierny dla poszczeg贸lnych kraj贸w. Stopa bezrobocia natomiast zdaje si male wraz z czasem w krajach, kt贸re uprzednio charakteryzoway si jej szczeg贸lnie wysokimi wartociami.

Wykresy kwantyl-kwantyl daj podstawy by twierdzi, 偶e wartoci wielu z badanych wska藕nik贸w nie pochodz z rozkadu normalnego. Wiele z nich jest prawo-skonych, czego wiadectwem s odsatjce od poszaostaych obserwacje o wysokich wartocicach. Ukadanie si obserwacji w ksztat przypominajcy "U" na niekt贸rych z wykres贸w mo偶e by r贸wnie偶 wiadectem leptokurtycznoci ich rozkad贸w.

W celu statystycznej weryfikacji normalnoi rozkad贸w zmiennych, dla wartoci ka偶dego wska藕nika w ka偶dym roku wykonano test normalnoci Shapiro-Wilka. Wartoci p. owych test贸w przedtsawiono w tabeli poni偶ej.

```{r}
#| echo: false
#| warning: false
#| message: false

vars <- c("DISP_INC_hh", "EXP", "G_CONS", "G_DEBT", "GDP_pc", "HICP", "UNEMP")
test_mat <- matrix(ncol = length(vars), nrow = length(YEARS))
colnames(test_mat) <- vars
rownames(test_mat) <- YEARS

shapiro_mat <- test_mat

for(i in vars){
  for(j in YEARS){
    p_val <- shapiro.test(unlist(data[data$time==j, i]))$p.value
    shapiro_mat[as.character(j),i] <- round(p_val, 4)
  }
}
rm(i, j, p_val)

#as.data.frame(shapiro_mat)
kable(shapiro_mat)
```

Jak wida, na poziomie istotnoci $\alpha$ = 0.05, jedynie Dochody gospodarstw domowych do dyspozycji na osob (DISP_INC_hh) nale偶y uzna za zmienn o rozkadzie normalnym. W przypadku pozostaych wska藕nik贸w nale偶y z du偶 pewnoci odrzuci hipotez o normalnoci rozkadu. Swego rodzaju wyjtek stanowi Indeks cen towar贸w i usug konsumenckich (HICP), gdzie test Shapiro-Wilka odrzuca hipotez normalnoci rozkadu jedynie w latach 2020 i 2022, czyli odpowiednio w roku wybuchu pandemii COVID-19 i roku rozpoczcia przez Rosj dziaa wojennych na Ukrainie.

Podsumowujc, nale偶y uzna, 偶e, z nielicznymi wyjtkami, wartoci wska藕nik贸w makroekonomicznych w krajach Unii Europejskiej nie pochodz z rozkadu normalnego. Pomimo, 偶e w kilku konkretnych przypadkach mo偶liwe byoby zastosowanie parametrycznych test贸w statystycznych do badania r贸偶nic wartoci wska藕nik贸w, w celu ujednolicenia procesu badawczego wszystkich zmiennych w dalszych etapach badania wykorzystywane bd nieparametryczne testy statystyczne.

## Badanie nier贸wnoci

W niniejszym rozdziale przeanalizowano nier贸wnoci w rozkadzie wybranych wska藕nik贸w ekonomicznych oraz spoeczno-demograficznych wr贸d kraj贸w Unii Europejskiej w latach 2019--2023. W analizie pominito Wska藕nik cen towar贸w i usug konsumpcyjnych (HICP), ze wzgldu na pojawiajce si tam ujemne wartoci.

Aby oceni stopie nier贸wnoci w rozkadzie wartoci tych wska藕nik贸w pomidzy poszczeg贸lnymi krajami, zastosowano wykresy krzywej Lorenza oraz obliczono wsp贸czynniki nier贸wnoci Gini'ego i Kukuy. Metody te pozwoliy na ukazanie zr贸偶nicowania spoeczno-ekonomicznego oraz wskazanie obszar贸w o szczeg贸lnie wysokiej koncentracji lub rozproszeniu badanego zjawiska.

W przypadku wielu z wska藕nik贸w, takich jak Stopa bezrobocia czy Przych贸d krajowy brutto na mieszkaca nie mo偶na interpretowa owych metod w zwyczajowy spos贸b opisujcy podzia pewnej cakowitej puli zasobu pomidzy jednostki. Jednak w tych przypadkach badanie nier贸wnoci dostarcza informacji o tym jak zr贸偶nicowane s wartoi wska藕nika na przestrzeni kraj贸w.

### Analiza wizualna

W celu wizualnej oceny nier贸wnoci w badanych wska藕nikach makroekonometrycznych por贸d kraj贸w Unii Europejskiej przedstawiono na wykresach krzyw Lorenz'a dla poszczeg贸lnych zmiennych w poszczecg贸lnych latach.

```{r}
#| echo: false
#| warning: false
#| message: false

setwd(paste(project_path, "/Wykresy/Lorenz", sep=""))

#Zmiana formatu danych dla odpowiedniego rysowania wykresu
#Inflcja pominita ze wzglu na ujemne wartoci
lorenz_data <- melt(data = data %>% select(-HICP), 
                    id.vars = c("time", "geo", "region"), 
                 variable.name = "variable", value.name = "value")

lorenz_data <- lorenz_data %>%
  group_by(variable, time) %>%
  summarize(lorenz = list(Lc(value)$L),
            p = list(Lc(value)$p),
            .groups = "drop") %>%
  unnest(c(p, lorenz)) %>%
  rename(L = lorenz)

file_name <- paste("Krzywe Lorenza.png")
title <- str_wrap("Krzywa Lorenza obrazujca dystrybucj lub zr贸偶nicowanie poszczeg贸lnych zmiennycw karajch UE w latach 2019-2023",
                  width = 70)

p <- ggplot(lorenz_data, aes(x = p, y = L)) +
  geom_line(color = "blue", size = 0.8) +
  geom_ribbon(aes(ymin = L, ymax = p), fill = "blue", alpha = 0.1)+
  geom_abline(intercept = 0, slope = 1, linetype = "dashed") +
  facet_grid(rows = vars(variable), cols = vars(time), scales = "free") +
  scale_y_continuous(n.breaks = 5) +
  scale_x_continuous(n.breaks = 5) +
  xlab("Kwantyl") +
  ylab("Skumulowany odsetek rozpatrywanej zmiennej") +
  ggtitle(title)+
  main_plot_theme +
  theme(panel.grid.major.x = element_line(colour = alpha("gray", 0.4)),
        axis.text.x = element_text(angle = 45, hjust = 1))

ggsave(filename = file_name, plot = p, height = 2400, width = 1800, units = "px")

rm(file_name, p, lorenz_data, title)
```

![Krzywa Lorenz'a](Wykresy/Lorenz/Krzywe%20Lorenza.png) Analizujc powy偶szy wykres zauwa偶y mo偶na du偶y stopie nier贸wnoci dystrypucji rocznych kwot Eksportu towar贸w i usug (EXP) oraz Rzdowych wydatk贸w na konsumpcj (G_CONS). Nale偶y si tego spodziewa, gdzy偶 s to kwoty cakowite, zale偶ne w du偶ej czci od wielkoci i liczby ludnoci w badanych krajach.

Co ciekawe wsp贸czynniki relatywne wzgldem wielkoci populacjii kraj贸w, jak np. Stopa bezrobocia (UNEMP) czy Dochody gospodarstw domowych do dyspozycji na mieszkaca (DISP_INC_hh) wykazuj si stosunkowo maym zr贸偶nicowaniem pomimo wydarze z analizowanego okresu.

Analizujc wykresy nie mo偶na stwierdzi zauwa偶alnego wpywu czasu na nier贸wno w poszczeg贸lnych wska藕nikach makroekonometrycznych na przestrzeni kraj贸w Unii Europejskiej. Mo偶na zatem wnioskowa, 偶e wpywy wydarze z badanych 5 lat na gospodarki poszczeg贸lnych kraj贸w nie r贸偶niy si midzy sob na tyle aby w znaczcy spos贸b pogb albo zniwelowa r贸偶nice ekonomiczne midzy krajami Unii Europejskiej.

### Indeksy nier贸wnoci

W tabelach poni偶ej przedstawiono wartoci indeksy nier贸wnoci Gini'ego oraz Kukuy. Analiza ich wasrtoci w czasie pozwala na ocenienie potencjalnych zmian zachodzcych z roku na rok z wiksz dokadnoci ni偶 u偶ycie narzdzi wizualnych. W obydwu przypadkach stosunkowo du偶e wartoci indeksu nier贸wnoci (bliskie 1) oznaczaj du偶 nier贸wno na tle badanego wska藕nika. Wartoco d偶ce do zera oznaczaj z kolei brak istotnych r贸偶nic w wartociach badanej zmiennej.

W tabelach poni偶ej przedstawiono wartoci Indeks贸w nier贸wnoci:

Indeks nier贸wnoci Gini'ego

```{r}
#| echo: false
#| warning: false
#| message: false

vars <- c("DISP_INC_hh", "EXP", "G_CONS", "G_DEBT", "GDP_pc", "UNEMP")

#Kolumny to zmienne, rzdy to lata
wsk_mat <- matrix(ncol = length(vars), nrow = length(YEARS))
colnames(wsk_mat) <- vars
rownames(wsk_mat) <- YEARS


# MACIERZ WARTOCI GINIEGO 
gini_mat<-wsk_mat

for (i in vars){
  for (j in YEARS){
    gini <- ineq(unlist(data[data$time==j, i]), type = "Gini")
    gini_mat[as.character(j),i] <- round(gini, 4)
  }
}

rm(i, j, gini)

#as.data.frame(gini_mat)
kable(gini_mat)
```

Indeks nier贸wnoci Kukuy:

```{r}
#| echo: false
#| warning: false
#| message: false

kuk_mat<-wsk_mat

a <- (27 + sqrt(27))/(27-1)
for (i in vars){
  for (j in YEARS){
    f<-sqrt(sum(apply(X=data[data$time==j, i], MARGIN = 1,
             FUN = function(x) x^2))/(sum(data[data$time==j, i])^2))
    kuk_mat[as.character(j),i] <- round((a*(f-1)) + 1 ,4)
    }
}

rm(a, i, j, f)

#as.data.frame(kuk_mat)
kable(kuk_mat)
```

Analiza wartoci indeks贸w nier贸noci w czasie potwierdza wnioski wysnute z analizy krzywych Lorenza. Eksport towar贸w i usug (EXP) oraz Rzdowe wydatki na konsumpcj (G_CONS) charakteryzuj si najwy偶szymi wartociami obydwu indeks贸w nier贸wnoci: odpowiednio ok 0.58-0.59 i 0.66-0.67 indeksu Gini'ego oraz ok. 0.14-0.15 i 0.20 - 0.21 indeksu Kukuy. Wartoci zdaj si wykazywa trend spadkowy, jednak zmiany s stosunkowo niewielkie i ci偶ko na ich podstawie wysnu wnioski o istotnych zmianach w dystrybucji wartoci tych wska藕nik贸w por贸d kraj贸w Unii Europejskiej.

Najmniejsz nier贸wno mo偶na obserwowa w przypadku Dochod贸w gospodarstw domowych do dyspozycji na osob (DISP_INC_hh) - wartoci indeks贸w Gini'ego i Kukuy wartoci nie przekraczaj odpowiedno 0.14 i 0.007. W przypadku indeksu nier贸wnoci Kukuy jest to a偶o jden rzd wielkoci mniej ni偶 w przypadku drugiego najmniej zr贸偶nicowanego wska藕nika - Stopy bezrobocia (UNEMP). Sugeruje to, 偶e w ujciu rednim moc nabywcza dochod贸w przypadajcych na jedn osob jest bardzo podobna w caej Unii Europejskiej. Co wicej mo偶na uzna, 偶e w badanym okresie nie stiwierdzono wystpowania wzmo偶onych nier贸wnoci na tym tle, a wrcz przeciwnie - zostay one w nieznacznym stopniu zmitygowane.

W tym zestawieniu za wska藕niki o rednim poziomie zr贸偶nicowania mo偶na uzna Rzdowe zadu偶enie (G_DEBT) oraz Przych贸d krajowy brutto na mieszkaca (GDP_pc). O ile w przypadku pierwszego z tych wska藕nik贸w oba indeksy nier贸wnoci wskazuj na jej stopniow redukcj (w latach 2019 - 2023 warto Indeksu nier贸wnoci Gini'ego spada o ok. 10%, a warto indeksu Kukuy - o ok. 20%), o tyle w przpyadku PKB per capita (GDP_pc) wska藕niki nie s zgodne co dynamiki zmian. Indeks Giniego wskazuje na nieznaczny wzrost nier贸wnoci w roku 2020 wzgldem 2019, po kt贸rym nastpuje jej stosunkowo niewielki, acz nieprzerwany spadek. Natomiast indeks Kukuy wskazuje na wzrost nier贸noci w latach 2019-2021 i spadek w p贸藕niejszych okresach. R贸偶nica ta wynika z odmiennych sposob贸w liczenia wska藕nik贸w. Kocowo mo偶na uzna, 偶e pandemia COVID-19 wywoaa pewne zmiany w r贸偶nicach Przychodu krajowego brutto na mieszkaca (GDP_pc) w krajach Unii Europejskiej widoczne w latach 2020 i 2021. Nie byy one jednak du偶e - zmiany wska藕nika z roku na rok nigdy nie osigny nawet 10% - co ci偶ko interpretowa jako znaczc zmiank szczeg贸lnie przy niewielkich co do modu贸w wartocich wska藕nik贸w.

Najwikszu spadek nier贸wnoci w czasie zaobserwowa mo偶na w przypadku Stopy bezrobocia (UNEMP). W latach 2019 - 2023 wyni贸s on nieco ponad 17% w przypadku indekus Gini'ego oraz niemal 45% dla indeksu Kukuy. Kocowym efektem jest warto indeks贸w, kt贸ra wskazuje na mae lub bardzo mae zr贸偶nicowanie stopy bezrobocia w krajach Unii Europejskiej. Biorc pod uwag ksztat wykres贸w kwatyl-kwantyl dla tego wska藕nika mo偶na wnioskowa, 偶e jest to w du偶ej mierze kwestia spadku stopy bezrobocia w kilku krajach, gdzie pocztkowo bya ona ponadprzecitnie wysoka.

### Wnioski

Podsumowujc, kraje Unii Europejskiej wysoce r贸偶ni si wartociami zagregowanych wska藕nik贸w, w tym przypadku: Eksportem towar贸w i usug (EXP) oraz Rzdowymi wydatkami na konsumpcj (G_CONS). Nale偶y jednak pamita, 偶e r贸偶nice te wywoane s w du偶ej czci r贸偶nicami w licbie ludnoci i wielkoci badanych kraj贸w - analizujc jedynie nier贸wno ich dystrybucji ci偶ko stwierdzi na ile wynika ona z innych wzgld贸w zwizanych z sytuacj ekonomiczn kraju. Zmiany wartoci indeks贸w nier贸noci w czasie zdaj si wskazywa na redukcj zr贸偶nicowania na bardzo nieznacznym poziomie. Niemo偶liwym jest wyodrbni wpyw wydarze z 2020 i 2022 roku na badane zjawisko.

Wartoci wska藕nik贸w relatywnych do wielkoci populacji lub PKB, czyli Dochod贸w gospodarstw domowych do dyspozycji na osob (DISP_INC_hh), Dugu rzdowego (G_DEBT) wyra偶onego jako % PKB kraju, Przychodu krajowego brutto na mieszkaca (PKB_pc) oraz stopy bezrobocia (UNEMP) stwierdzi mo偶na rednie lub niewielkie zr贸偶nicowanie. Dynamika zmian nier贸wnoci zdaje si wskazywa na ich nienzaczny spadek, kt贸rego nie zak贸ci w znacznym stopniu wybuch pandemii ani wojny. Wyjtek stanowi Przych贸d krajowy brutto na mieszkaca (GDP_pc), gdzie w okresie trwania pandemii COVID-19 nier贸wno pomidzy krajami wzrosa nieznacznie. Wpyw tego okresu zosta jednak cakowicie zniwelowany do momentu ostatnigo okresu, czyli roku 2023.

Odnoszc si do postawionej we wstpie hipotezy: analizujc nier贸wnoci w badanych wska藕nikach makroekonomicznych kraj贸w Unii Europejskiej nie mo偶na stwierdzi jasnego powizania midzy poziomem ich zr贸偶nicowania a pandemi COVID-19 czy wojn na terenie Ukrainy. W zwizku z tym nale偶y uzna, 偶e wpyw tych wydarze na sytuacj gospodarcz kraj贸w by raczej podobny lub losowy w spos贸b, kt贸ry nie zaburza wystpujcych uprzednio na terenie Unii Europejskiej r贸偶nic makroekonomicznych.

## Analiza zmian wska藕nik贸w w czasie

Jak zostao ustalone, na podstawie wizualnych rozkad贸w gstoci i testu Shapiro-Wilka, badane zmienne nie charakteryzuje rzokad normalny. Dlatego w celu dalszego badania zostana zastosowane testy nieparametryczne jak: Test Wilcoxona i Friedmana. S to nieparametryczne testy statystyczne pozwalajce okreli, czy r贸偶nice midzy badanymi np.okresami s statystycznie istotne. 


### Analiza wizualna
```{r}
#| echo: false
#| warning: false
#| message: false
setwd(paste(project_path, "/Wykresy/Boxploty", sep=""))

for(i in vars){
  title <- str_wrap(var_names[[i]], width = 70)
  
  file_name <- paste(i, ".png", sep="")
  
  p <- ggplot(data, aes(x = time, y = unlist(data[i]))) +
    geom_boxplot(outlier.shape = NA, fill = alpha("blue", 0.1)) + 
    geom_point(position = jitter, size=2, 
               aes(x = time, y = unlist(data[i]), color = geo)) + 
    geom_text_repel(mapping = aes(label=  geo), color = "black",  size = 2, 
                    max.overlaps = 20, position = jitter, min.segment.length = 0) +
    scale_y_continuous(n.breaks = 8) + 
    xlab("Rok") +
    ylab("") + 
    ggtitle(title) +
    main_plot_theme
  
    ggsave(filename = file_name, plot = p, height = 1600, width = 2400, units = "px")
}

rm(i, p, file_name, title)
```



### Testy statystyczne

### Wnioski

## Podsumowanie
