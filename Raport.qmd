---
title: "Raport"
author: "Dominik Mieszkowski, Dagmara y"
format: html
editor: visual
---

# Analiza wybranych wzka藕nik贸w makroekonomicznych w krajach Unii Europejskiej w latach 2019-2025

Dagmara y, s211011\@sggw.edu.pl\
Dominik Mieszkowski s211015\@sggw.edu.pl\

## Wprowadzenie

Wska藕niki makroekonomiczne peni kluczow rol w opisywaniu i ocenie sytuacji gospodarczej kraju. Ich wartoci odzwierciedlaj sytuacj finasow rzdu pastwa, a tak偶e warunki ekonomiczne w jakich funkcjonuj przdesibiorstwa i gospodartwa domowe na jego terenie. W ostatnich latach wybuch pandemii wirusa COVID-19 w 2020 r., a tak偶e rozpoczcie przez Rosj wojny na Ukrainie w lutym 2022 r. wstrzsny Europ, wpywajc na handel, rynek pracy i ludno. Aby oceni rodzaj i zakres zmian spoeczno-ekonomicznych w tym okresie, koniecznym jest przyjrzenie si zmianom w wartociach wspomnainych wska藕nik贸w, kt贸re towarzyszyly tym wydarzeniom. Temat ten jest podjty w tej pracy, uwzgldniajc 27 patw obecnie wchodzcych w skad Unii Europejskiej w latach 2019-2023.

### Streszczenie

### Sowa kluczowe

wska藕nk makroekonomiczny, Unia Europejska, COVID-19, wojna, nier贸wno, analiza Wizualna, test Wilcoxona, krzywa Lorenza, indeks Gini'ego

### Cele i hipotezy

Celem badania jest wykazanie wpywu pandemii COVID-19 oraz wybuchu wojny na Ukrainie na sytuacj gospodarcz kraj贸w Unii Europejskiej. Zmiana taka powinna by odzwierciedlona zauwa偶aln r贸偶nic w wartocich wybranych wska藕nik贸w makroekonomicznych w czasie, dotyczc caoksztatu Unii Europejskiej. Zmiana taka mo偶e mie jednolity charakter i dotyczy wszytskich pastw w jednakowy spos贸b lub mie wpywa na pastwa w r贸偶nym stopniu, redukujc lub amplifikujc wystpujce midzy pastwami wystpujce uprzednio na danym tle nier贸wnoci. Cel 贸w jest r贸noznaczny z potwierdzeniem dw贸ch hipotez badawczych:

-   Pandemia COVID-19 miay negatywny wpyw na sytuacj ekonomiczn kraj贸w Unii Europejskiej oraz jej ludnoci.
-   Zmiany wywoane tymi wydarzeniami nie dotykay kraj贸w jednakowo, powodujc zmiany w wystpujcych midzy nimi nier贸wnociach makroekonomicznych.

### Przegld literatury

## Dane

```{r}
#| echo: false
#| warning: false
#| message: false
p<-c("eurostat", "tidyr", "tmap", "sf", "dplyr", "stringr", "purrr",
     "ggplot2", "tidyr", "reshape2", "dplyr", "stringr", "ineq")

for (i in p){
  #if(!require(i, character.only = TRUE)){install.packages(i)}
  if(!i %in% installed.packages()){
    install.packages(i)
  }
  library(i, character.only = TRUE)
}
rm(p, i)

#Wczytanie kod贸w pastw UE
CNTR_eu<-unlist(eu_countries %>%
  mutate(geo=code) %>%
  select(geo))
YEARS=2019:2023

# WCZYTANIE DANYCH Z EUROSTATU ####
# Real GDP per capita ####
#ewentualnie "sdg_08_10" bo jako base year u偶ywa 2020, a nie 2015
GDP_pc<- get_eurostat(id = "tipsna40", time_format = "num",
                      filters = list(time = YEARS, 
                                     freq = "A", 
                                     geo = CNTR_eu)) %>%
  select(geo, time, values) %>%
  rename(GDP_pc = values)


# Uneployment Rate ####
UNEMP <- get_eurostat(id = "tps00203", time_format = "num",
                      filters = list(time = YEARS, 
                                     freq = "A", 
                                     geo = CNTR_eu, 
                                     unit = "PC_ACT")) %>%
  select(geo, time, values) %>%
  rename(UNEMP = values)



# HICP - inflation rate
HICP <- get_eurostat(id = "tec00118", time_format = "num",
                     filters = list(time = YEARS, 
                                    freq = "A", 
                                    geo = CNTR_eu)) %>%
  select(geo, time, values) %>%
  rename(HICP = values)


# Governemntal consumption expenditure (Percentage of GDP) ####
G_CONS <- get_eurostat(id = "tec00010", time_format = "num",
                       filters = list(time = YEARS, 
                                      freq = "A", 
                                      geo = CNTR_eu, 
                                      unit = "CP_MEUR")) %>%
  select(geo, time, values) %>%
  rename(G_CONS = values)



# General government gross debt - Percentage of gross domestic product (GDP) ####
G_DEBT <- get_eurostat(id = "sdg_17_40", time_format = "num",
                       filters = list(time = YEARS, 
                                      freq = "A", 
                                      geo = CNTR_eu, 
                                      unit = "PC_GDP")) %>%
  select(geo, time, values) %>%
  rename(G_DEBT = values)


# Adjusted gross disposable income of households per capita in PPS ####
DISP_INC_hh <- get_eurostat(id = "tec00113", time_format = "num",
                            filters = list(time = YEARS, 
                                           freq = "A", 
                                           geo = CNTR_eu)) %>%
  select(geo, time, values) %>%
  rename(DISP_INC_hh = values)


# Export of goods and servieces in % of GDP ####
EXP <- get_eurostat(id = "nama_10_gdp", time_format = "num",
                    filters = list(time = YEARS, 
                                   freq = "A", 
                                   geo = CNTR_eu,
                                   na_item = "P6",
                                   unit = "CP_MEUR")) %>%
  select(geo, time, values) %>%
  rename(EXP = values)

dfs <- list(DISP_INC_hh, EXP, G_CONS, G_DEBT, GDP_pc,
            HICP, UNEMP)
data <- reduce(dfs, function(x, y) full_join(x, y, by = c("geo", "time")))

rm(DISP_INC_hh, EXP, G_CONS, G_DEBT, GDP_pc,
   HICP, UNEMP)
rm(dfs)


eu_north <- c("DK", "EE", "FI", "IE", "LV", "LT", "SE")
eu_south <- c("HR", "CY", "EL", "IT", "MT", "PT", "SI", "ES")
eu_east  <- c("BG", "CZ", "HU", "PL", "RO", "SK")
eu_west  <- c("AT", "BE", "FR", "DE", "LU", "NL")

data <- data %>%
  mutate(region = case_when(
    geo %in% eu_north ~ "North",
    geo %in% eu_south ~ "South",
    geo %in% eu_east  ~ "East",
    geo %in% eu_west  ~ "West"))

rm(eu_east, eu_south, eu_north, eu_west)

data$time <- as.factor(data$time)
data$geo <- as.factor(data$geo)



# Obliczanie NA dla Bugari w DISP_INC_hh
# Microeconometrics (Methods and Applications) || Missing Data and Imputation 
# Cambridge University Press, 2005 may 09
# Cameron, A. Colin; Trivedi, Pravin K

#uzupenianie brakujcej danej
# MODEL Z CZASEM 
danee<-data
danee$time <- as.numeric(as.character(danee$time))
model_data <- danee[danee$geo == "BG", ] %>% filter(!is.na(DISP_INC_hh)) 

#model dla bugarii
model <- lm(DISP_INC_hh ~ time, data = model_data)


missing_rows <- danee %>%
  filter(is.na(DISP_INC_hh) & geo == "BG") %>%
  select(time, DISP_INC_hh)

predicted <- predict(model, newdata = missing_rows)

data$DISP_INC_hh[danee$geo == "BG" & is.na(danee$DISP_INC_hh)] <- predicted

rm(danee, missing_rows, model, model_data, predicted)

```

### 殴r贸do i zakres danych

Dane pochodz w caoci ze zbior贸w udostpnionych przez Eurostat. Szczeg贸y dotyczcze baz danych, z kt贸rych pochodz poszczeg贸lne wska藕niki opisane s w sekcji powiconej opisowi zmiennych. Zbi贸r danych obejmuje wartoci 7 wska偶nik贸w makroekonometrycznych, podawanych z roczn czstotliwoci na przestrzeni lat 2019-2023. W badaniu uwzgldnione zostao 27 pastw wchodzcych w skad Unii Europejskiej z roku 2020. W badaniu nie zostay uwzgldnione kraje nienale偶ce do Unii Europejskiej, ale wp贸pracujce z Eurostatem w zakresie statystyki publicznej.

### Opis zmiennych

Tak jak wspomnaino wy偶ej badane zmienne stanowi 7 wska藕nik贸w makroekonomicznych: Przych贸d krajowy brutto na mieszkaca, Stopa bezrobocia, Wska藕nik cen towar贸w i usug koncumpcyjnych, Wydati rzdowe na konsumpcj, Zadu偶enie rzdowe brutto, Skorygowany doch贸d brutto do dyspozycji na mieszkaca, Eksport towar贸w i usug. Szczag贸y dotyczce zmiennych przedstawiono poni偶ej

| Nazwa       | Opis                                                                               | Jednostka                          | Baza Danych |
|:-----------------|:-----------------|:-----------------|:------------------|
| GDP_pc      | Przych贸d krajowy brutto na jednego miszkaca                                       | EUR, ceny bie偶ce                  | tipsna40    |
| UNEMP       | Stoba bezrobocia                                                                   | \%                                 | tps00203    |
| HICP        | Wska藕niki cen towar贸w i usug konsumpcyjnych (pot. infalcja)                       | \-                                 | tec00118    |
| G_CONS      | Wydatki rzdowe na konsumpcj                                                      | mln EUR, ceny bie偶ce              | tec00010    |
| G_DEBT      | Zadu偶enie rzdowe brutto                                                          | \% PKB                             | sdg_17_40   |
| DISP_INC_hh | Skorygowany doch贸d rozporzdzany doch贸d gospodarstw domowych na jednego mieszkaca | Standard siy nabywczej (PPS 2020) | tec00113    |
| EXP         | Eksport towar贸w i usug                                                            | mln EUR, ceny bie偶ce              | nama_10_gdp |

### Statystyki opisowe

### Badanie normalnoci rozkadu

W celu okrelenia czy nale偶y uzna, 偶e badane obserwacje pochodz z rozkadu normalnego wykonano wykresy kwantyl-kwantyl oraz przeprowadzono testy statystyczne Shapiro wilka.

```{r}
#| echo: false
#| warning: false
#| message: false
#| include: false

project_path <- "C:/Users/miesz/Desktop/Studia/Projekt-Analiza-Danych-Unii-Europejskiej"

#Ograniczenie wywietlania liczb w notacji wykadniczej
options(scipen = 9999)

#Rozrzut punkt贸w (dla czytelnoci)
jitter <- position_jitter(width = 0.3, height = 0, seed=123)

#Ustalenie wsp贸lnego motywu
main_plot_theme <- theme(legend.position = "none", #brak legendy
                         panel.background = element_rect(fill = "white"),
                         panel.border = element_rect(colour = "black", fill = NA),
                         panel.grid.major.y = element_line(colour = alpha("gray", 0.4)),
                         plot.title = element_text(hjust = 0.5)) 

setwd(paste(project_path, "/Wykresy/q-q", sep=""))

title <- str_wrap("Wykresy kwantyl-kwantyl dla poszczeg贸lnych zmiennych na przestrzeni lat", width = 50)

q_q_data <- melt(data=data, id.vars = c("time", "geo", "region"), 
                 variable.name = "variable", value.name = "value")

file_name <- paste("Wykres q-q.png")
title <- str_wrap("Wykresy kwantyl-kwantyl dla poszczeg贸lnych zmiennych na przestrzeni lat",
                  width = 50)
  
p <- ggplot(q_q_data, aes(sample = value)) +
  geom_qq_line() +
  geom_qq()+
  facet_grid(rows = vars(variable), cols = vars(time), scales = "free") +
  scale_y_continuous(n.breaks = 4) +
  ylab("Wartoci rzeczywste zmiennych") +
  xlab("Teoretyczne wartoci rozkadu normalnego") +
  ggtitle(title) +
  main_plot_theme +
  theme(panel.grid.major.x = element_line(colour = alpha("gray", 0.4)))
  
ggsave(filename = file_name, plot = p, height = 2400, width = 1800, units = "px")


rm(p, file_name, q_q_data)

```

![Wykres q-q](Wykresy/q-q/Wykres%20q-q.png)

Wykresy kwartyl-kwartyl por贸wnujce rozkad badanych wska藕nik贸w w krajach Unii Europejskiej ze standardowym rozkadem normalnym zdaj si wykazywa rozbie偶no midzy nimi. Eksport towar贸w i usug (EXP), Rzdowe wydatki na konsumpcj (G_CONS), Zadu偶enie rzdowe (G_DEBT), PKB na mieszkaca (GDP-pc) oraz Stopa Bezrobocia (UNEMP) niezale偶nie do roku charakteryzuj si obserwacjami po prawej stronie poo偶onymi zauwa偶alnie powy偶ej linii symbolizujcej rozkad normalny. Zjawisko to jest szczeg贸lnie silne w przypadku Eksportu oraz Wydatk贸w na konsumpcj. Wzorzec taki odzwierciedla istnienie kraj贸w plasujcych si pod tymi wzgldami znaczcow wy偶ej od pozostaych, co oznacza niesymetryczny rozkad obserwacji wok贸 redniej.

W przypadku niekt贸rych wska藕nik贸w, np. Dochod贸w gospodarstw domowych od dyspozycji (DISP_INC_hh) oraz Eksportu towar贸w i usug (EXP) zauwa偶y te偶 mo偶na analogiczne zjawisko dla niskich wartoci wska藕nik贸w (reprezentowanych po lewej stronie wykres贸w) lecz nie jest ono tak zauwa偶alne jak w przyadku wartoci wysokich.

Wykrey Indeksu cen towar贸w i usug konsumenckich (HICP) oraz Stopy bezrobocia (UNEMP) w najbardziej zauwa偶alny spos贸b zmieniaj si w czasie. W przypadku Indeksu cen towar贸w i usug konsumenckich, zmiana ta wskazuje na wstrzs towarzyszcy rozpoczciu wojny w roku 2022, kt贸ry doproadzi do og贸lnego wzrostu iinfalcji, w spos贸b nier贸wnomierny dla poszczeg贸lnych kraj贸w. Stopa bezrobocia natomiast zdaje si male wraz z czasem w krajach, kt贸re uprzednio charakteryzoway si jej szczeg贸lnie wysokimi wartociami.

Wykresy kwantyl-kwantyl daj podstawy by twierdzi, 偶e wartoci wielu z badanych wska藕nik贸w nie pochodz z rozkadu normalnego. Wiele z nich jest prawo-skonych, czego wiadectwem s odsatjce od poszaostaych obserwacje o wysokich wartocicach. Ukadanie si obserwacji w ksztat przypominajcy "U" na niekt贸rych z wykres贸w mo偶e by r贸wnie偶 wiadectem platokurtycznoci ich rozkad贸w.

W celu statystycznej weryfikacji normalnoi rozkad贸w zmiennych, dla wartoci ka偶dego wska藕nika w ka偶dym roku wykonano test normalnoci Shapiro-Wilka. Wartoci p. owych test贸w przedtsawiono w tabeli poni偶ej.

```{r}
#| echo: false
#| warning: false
#| message: false

vars <- c("DISP_INC_hh", "EXP", "G_CONS", "G_DEBT", "GDP_pc", "HICP", "UNEMP")
test_mat <- matrix(ncol = length(vars), nrow = length(YEARS))
colnames(test_mat) <- vars
rownames(test_mat) <- YEARS

shapiro_mat <- test_mat

for(i in vars){
  for(j in YEARS){
    p_val <- shapiro.test(unlist(data[data$time==j, i]))$p.value
    shapiro_mat[as.character(j),i] <- round(p_val, 4)
  }
}
rm(i, j, p_val)

as.data.frame(shapiro_mat)
```

Jak wida, na poziomie istotnoci $\alpha$ = 0.05, jedynie Dochody gospodarstw domowych do dyspozycji na osob (DISP_INC_hh) nale偶y uzna za zmienn o rozkadzie normalnym. W przypadku pozostaych wska藕nik贸w nale偶y z du偶 pewnoci odrzuci hipotez o normalnoci rozkadu. Swego rodzaju wyjtek stanowi Indeks cen towar贸w i usug konsumenckich (HICP), gdzie test Shapiro-Wilka odrzuca hipotez normalnoci rozkadu jedynie w latach 2020 i 2022, czyli odpowiednio w roku wybuchu pandemii COVID-19 i roku rozpoczcia przez Rosj dziaa wojennych na Ukrainie.

Podsumowujc, nale偶y uzna, 偶e, z nielicznymi wyjtkami, wartoci wska藕nik贸w makroekonomicznych w krajach Unii Europejskiej nie pochodz z rozkadu normalnego. Pomimo, 偶e w kilku konkretnych przypadkach mo偶liwe byoby zastosowanie parametrycznych test贸w statystycznych do badania r贸偶nic wartoci wska藕nik贸w, w celu ujednolicenia procesu badawczego wszystkich zmiennych w dalszych etapach badania wykorzystywane bd nieparametryczne testy statystyczne.

## Badanie nier贸wnoci

W niniejszym rozdziale przeanalizowano nier贸wnoci w rozkadzie wybranych wska藕nik贸w ekonomicznych oraz spoeczno-demograficznych wr贸d kraj贸w Unii Europejskiej w latach 2019--2023. W analizie pominito Wska藕nik cen towar贸w i usug konsumpcyjnych (HICP), ze wzgldu na pojawiajce si tam ujemne wartoci.

Aby oceni stopie nier贸wnoci w rozkadzie wartoci tych wska藕nik贸w pomidzy poszczeg贸lnymi krajami, zastosowano wykresy krzywej Lorenza oraz obliczono wsp贸czynniki nier贸wnoci Gini'ego i Kukuy. Metody te pozwoliy na ukazanie zr贸偶nicowania spoeczno-ekonomicznego oraz wskazanie obszar贸w o szczeg贸lnie wysokiej koncentracji lub rozproszeniu badanego zjawiska.

W przypadku wielu z wska藕nik贸w, takich jak Stopa bezrobocia czy Przych贸d krajowy brutto na mieszkaca nie mo偶na interpretowa owych metod w zwyczajowy spos贸b opisujcy podzia pewnej cakowitej puli zasobu pomidzy jednostki. Jednak w tych przypadkach badanie nier贸wnoci dostarcza informacji o tym jak zr贸偶nicowane s wartoi wska藕nika na przestrzeni kraj贸w.

### Analiza wizualna

W celu wizualnej ocny nier贸wnoci w badanych wska藕nikach makroekonometrycznych por贸d kraj贸w Unii Europejskiej przedstawiono na wykresach krzyw Lorenz'a dla poszczeg贸lnych zmiennych w poszczecg贸lnych latach.

```{r}
#| echo: false
#| warning: false
#| message: false

setwd(paste(project_path, "/Wykresy/Lorenz", sep=""))

#Zmiana formatu danych dla odpowiedniego rysowania wykresu
#Inflcja pominita ze wzglu na ujemne wartoci
lorenz_data <- melt(data = data %>% select(-HICP), 
                    id.vars = c("time", "geo", "region"), 
                 variable.name = "variable", value.name = "value")

lorenz_data <- lorenz_data %>%
  group_by(variable, time) %>%
  summarize(lorenz = list(Lc(value)$L),
            p = list(Lc(value)$p),
            .groups = "drop") %>%
  unnest(c(p, lorenz)) %>%
  rename(L = lorenz)

file_name <- paste("Krzywe Lorenza.png")
title <- str_wrap("Krzywa Lorenza obrazujca dystrybucj poszczeg贸lnych zmiennyc
                  w karajch UE w poszczeg贸lnych latach",
                  width = 70)

p <- ggplot(lorenz_data, aes(x = p, y = L)) +
  geom_line(color = "blue", size = 0.8) +
  geom_ribbon(aes(ymin = L, ymax = p), fill = "blue", alpha = 0.1)+
  geom_abline(intercept = 0, slope = 1, linetype = "dashed") +
  facet_grid(rows = vars(variable), cols = vars(time), scales = "free") +
  scale_y_continuous(n.breaks = 5) +
  scale_x_continuous(n.breaks = 5) +
  xlab("Kwantyl") +
  ylab("Skumulowany odsetek rozpatrywanej zmiennej") +
  ggtitle(title)+
  main_plot_theme +
  theme(panel.grid.major.x = element_line(colour = alpha("gray", 0.4)),
        axis.text.x = element_text(angle = 45, hjust = 1))

ggsave(filename = file_name, plot = p, height = 2400, width = 1800, units = "px")
```

![Krzywa Lorenz'a](Wykresy/Lorenz/Krzywe Lorenza.png)
Analizujc powy偶szy wykres zauwa偶y mo偶na du偶y stopie nier贸wnoci dystrypucji rocznych kwot Eksportu towar贸w i usug (EXP) oraz Rzdowych wydatk贸w na konsumpcj (G_CONS). Nale偶y si tego spodziewa, gdzy偶 s to kwoty cakowite, zale偶ne w du偶ej czci od wielkoci i liczby ludnoci w badanych krajach.

Co ciekawe wsp贸czynniki relatywne wzgldem wielkoci populacjii kraj贸w, jak np. Stopa bezrobocia (UNEMP) czy Dochody gospodarstw domowych do dyspozycji na mieszkaca (DISP_INC_hh) wykazuj si stosunkowo maym zr贸偶nicowaniem pomimo wydarze z analizowanego okresu. 

Analizujc wykresy nie mo偶na stwierdzi zauwa偶alnego wpywu czasu na nier贸wno w poszczeg贸lnych wska藕nikach makroekonometrycznych na przestrzeni kraj贸w Unii Europejskiej. Mo偶na zatem wnioskowa, 偶e wpywy wydarze z badanych 5 lat na gospodarki poszczeg贸lnych kraj贸w nie r贸偶niy si midzy sob na tyle aby w znaczcy spos贸b pogb albo zniwelowa r贸偶nice ekonomiczne midzy krajami Unii Europejskiej. 

### Indeksy nier贸wnoci

### Wnioski

## Analizma zmian wska藕nik贸w w czasie

### Analiza wizualna

### Testy statystyczne

### Wnioski

## Podsumowanie

```{r}
#| echo: false
2 * 2
```

The `echo: false` option disables the printing of code (only output is displayed).
